/**
 * jQuery Roundabout - v2.4.3
 * Resolved changing size bug and crashing if loading images was too big 
 * Abdulhamid AlAttar
 **/
/**
 * jQuery Roundabout - v2.4.2 http://fredhq.com/projects/roundabout
 * 
 * Moves list-items of enabled ordered and unordered lists long a chosen path.
 * Includes the default "lazySusan" path, that moves items long a spinning
 * turntable.
 * 
 * Terms of Use // jQuery Roundabout
 * 
 * Open source under the BSD license
 * 
 * Copyright (c) 2011-2012, Fred LeBlanc All rights reserved.
 * 
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *  - Redistributions of source code must retain the above copyright notice,
 * this list of conditions and the following disclaimer. - Redistributions in
 * binary form must reproduce the above copyright notice, this list of
 * conditions and the following disclaimer in the documentation and/or other
 * materials provided with the distribution. - Neither the name of the author
 * nor the names of its contributors may be used to endorse or promote products
 * derived from this software without specific prior written permission.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 * POSSIBILITY OF SUCH DAMAGE.
 */
(function(c){var t,u,g;c.extend({roundaboutShapes:{def:"lazySusan",lazySusan:function(a,b,c){return{x:Math.sin(a+b),y:Math.sin(a+3*Math.PI/2+b)/8*c,z:(Math.cos(a+b)+1)/2,scale:Math.sin(a+Math.PI/2+b)/2+.5}}}});t={bearing:0,tilt:0,minZ:100,maxZ:280,minOpacity:.4,maxOpacity:1,minScale:.4,maxScale:1,duration:600,btnNext:null,btnNextCallback:function(){},btnPrev:null,btnPrevCallback:function(){},btnToggleAutoplay:null,btnStartAutoplay:null,btnStopAutoplay:null,easing:"swing",clickToFocus:!0,clickToFocusCallback:function(){},focusBearing:0,shape:"lazySusan",debug:!1,childSelector:"li",startingChild:null,reflect:!1,floatComparisonThreshold:.001,autoplay:!1,autoplayDuration:1E3,autoplayPauseOnHover:!1,autoplayCallback:function(){},autoplayInitialDelay:0,enableDrag:!1,dropDuration:600,dropEasing:"swing",dropAnimateTo:"nearest",dropCallback:function(){},dragAxis:"x",dragFactor:4,triggerFocusEvents:!0,triggerBlurEvents:!0,responsive:!1};u={autoplayInterval:null,autoplayIsRunning:!1,autoplayStartTimeout:null,animating:!1,childInFocus:-1,touchMoveStartPosition:null,stopAnimation:!1,lastAnimationStep:!1};g={init:function(a,b,h){var d;(new Date).getTime();a="object"===typeof a?a:{};b=c.isFunction(b)?b:function(){};b=c.isFunction(a)?a:b;d=c.extend({},t,a,u);return this.each(function(){var a=c(this),m=a.children(d.childSelector).length,k=360/m,m=d.startingChild&&d.startingChild>m-1?m-1:d.startingChild,n=null===d.startingChild?d.bearing:360-m*k,p="static"!==a.css("position")?a.css("position"):"relative";a.css({padding:0,position:p}).addClass("roundabout-holder").data("roundabout",c.extend({},d,{startingChild:m,bearing:n,oppositeOfFocusBearing:g.normalize.apply(null,[d.focusBearing-180]),dragBearing:n,period:k}));h?a.unbind(".roundabout").children(d.childSelector).unbind(".roundabout"):d.responsive&&c(window).bind("resize.roundabout",function(){g.stopAutoplay.apply(a);g.relayoutChildren.apply(a)});d.clickToFocus&&a.children(d.childSelector).each(function(b){c(this).bind("click.roundabout",function(){var d=g.getPlacement.apply(a,[b]);if(!g.isInFocus.apply(a,[d]))return g.stopAnimation.apply(c(this)),a.data("roundabout").animating||g.animateBearingToFocus.apply(a,[d,a.data("roundabout").clickToFocusCallback]),!1})});d.btnNext&&c(d.btnNext).bind("click.roundabout",function(){a.data("roundabout").animating||g.animateToNextChild.apply(a,[a.data("roundabout").btnNextCallback]);return!1});d.btnPrev&&c(d.btnPrev).bind("click.roundabout",function(){g.animateToPreviousChild.apply(a,[a.data("roundabout").btnPrevCallback]);return!1});d.btnToggleAutoplay&&c(d.btnToggleAutoplay).bind("click.roundabout",function(){g.toggleAutoplay.apply(a);return!1});d.btnStartAutoplay&&c(d.btnStartAutoplay).bind("click.roundabout",function(){g.startAutoplay.apply(a);return!1});d.btnStopAutoplay&&c(d.btnStopAutoplay).bind("click.roundabout",function(){g.stopAutoplay.apply(a);return!1});d.autoplayPauseOnHover&&a.bind("mouseenter.roundabout.autoplay",function(){g.stopAutoplay.apply(a,[!0])}).bind("mouseleave.roundabout.autoplay",function(){g.startAutoplay.apply(a)});d.enableDrag&&(c.isFunction(a.drag)?c.isFunction(a.drop)?a.drag(function(b,d){var c=a.data("roundabout"),h="x"===c.dragAxis.toLowerCase()?"deltaX":"deltaY";g.stopAnimation.apply(a);g.setBearing.apply(a,[c.dragBearing+d[h]/c.dragFactor])}).drop(function(b){b=a.data("roundabout");var d=g.getAnimateToMethod(b.dropAnimateTo);g.allowAnimation.apply(a);g[d].apply(a,[b.dropDuration,b.dropEasing,b.dropCallback]);b.dragBearing=b.period*g.getNearestChild.apply(a)}):d.debug&&alert("You do not have the drop plugin loaded."):d.debug&&alert("You do not have the drag plugin loaded."),a.each(function(){var a=c(this).get(0),b=c(this).data("roundabout"),d="x"===b.dragAxis.toLowerCase()?"pageX":"pageY",h=g.getAnimateToMethod(b.dropAnimateTo);a.addEventListener&&(a.addEventListener("touchstart",function(a){b.touchMoveStartPosition=a.touches[0][d]},!1),a.addEventListener("touchmove",function(a){var h=(a.touches[0][d]-b.touchMoveStartPosition)/b.dragFactor;a.preventDefault();g.stopAnimation.apply(c(this));g.setBearing.apply(c(this),[b.dragBearing+h])},!1),a.addEventListener("touchend",function(a){a.preventDefault();g.allowAnimation.apply(c(this));h=g.getAnimateToMethod(b.dropAnimateTo);g[h].apply(c(this),[b.dropDuration,b.dropEasing,b.dropCallback]);b.dragBearing=b.period*g.getNearestChild.apply(c(this))},!1))}));g.initChildren.apply(a,[b,h])})},initChildren:function(a,b){var h=c(this),d=h.data("roundabout");a=a||function(){};b?d.relayoutProportion=h.width()/d.startWidth:(d.relayoutProportion=1,d.startWidth=h.width());h.children(d.childSelector).each(function(a){var d,k,n,p=g.getPlacement.apply(h,[a]);b&&c(this).data("roundabout")&&(d=c(this).data("roundabout").startWidth,k=c(this).data("roundabout").startHeight,n=c(this).data("roundabout").startFontSize);c(this).addClass("roundabout-moveable-item").css("position","absolute");c(this).data("roundabout",{startWidth:d||c(this).width(),startHeight:k||c(this).height(),startFontSize:n||parseInt(c(this).css("font-size"),10),degrees:p,backDegrees:g.normalize.apply(null,[p-180]),childNumber:a,currentScale:1,parent:h})});g.updateChildren.apply(h);d.autoplay&&(d.autoplayStartTimeout=setTimeout(function(){g.startAutoplay.apply(h)},d.autoplayInitialDelay));h.trigger("ready");a.apply(h);return h},updateChildren:function(){return this.each(function(){var a=c(this),b=a.data("roundabout"),h=-1,d={bearing:b.bearing,tilt:b.tilt,stage:{width:Math.floor(.9*c(this).width()),height:Math.floor(.9*c(this).height())},animating:b.animating,inFocus:b.childInFocus,focusBearingRadian:g.degToRad.apply(null,[b.focusBearing]),shape:c.roundaboutShapes[b.shape]||c.roundaboutShapes[c.roundaboutShapes.def]};d.midStage={width:d.stage.width/2,height:d.stage.height/2};d.nudge={width:d.midStage.width+.05*d.stage.width,height:d.midStage.height+.05*d.stage.height};d.zValues={min:b.minZ,max:b.maxZ,diff:b.maxZ-b.minZ};d.opacity={min:b.minOpacity,max:b.maxOpacity,diff:b.maxOpacity-b.minOpacity};d.scale={min:b.minScale,max:b.maxScale,diff:b.maxScale-b.minScale};a.children(b.childSelector).each(function(f){!g.updateChild.apply(a,[c(this),d,f,function(){c(this).trigger("ready")}])||d.animating&&!b.lastAnimationStep?c(this).removeClass("roundabout-in-focus"):(h=f,c(this).addClass("roundabout-in-focus"))});h!==d.inFocus&&(b.triggerBlurEvents&&a.children(b.childSelector).eq(d.inFocus).trigger("blur"),b.childInFocus=h,b.triggerFocusEvents&&-1!==h&&a.children(b.childSelector).eq(h).trigger("focus"));a.trigger("childrenUpdated")})},updateChild:function(a,b,h,d){var f;a=c(a);h=this.data("roundabout");var m=a.data("roundabout"),k=[];f=g.degToRad.apply(null,[360-m.degrees+b.bearing]);d=d||function(){};f=g.normalizeRad.apply(null,[f]);f=b.shape(f,b.focusBearingRadian,b.tilt);f.scale=1<f.scale?1:f.scale;f.adjustedScale=(b.scale.min+b.scale.diff*f.scale).toFixed(4);f.adjustedScale*=h.relayoutProportion;f.width=(f.adjustedScale*m.startWidth).toFixed(4);f.height=(f.adjustedScale*m.startHeight).toFixed(4);a.css({left:(f.x*b.midStage.width+b.nudge.width-f.width/2).toFixed(0)+"px",top:(f.y*b.midStage.height+b.nudge.height-f.height/2).toFixed(0)+"px",width:f.width+"px",height:f.height+"px",opacity:(b.opacity.min+b.opacity.diff*f.scale).toFixed(2),zIndex:Math.round(b.zValues.min+b.zValues.diff*f.z),fontSize:(f.adjustedScale*m.startFontSize).toFixed(1)+"px"});m.currentScale=f.adjustedScale;this.data("roundabout").debug&&(k.push('<div style="font-weight: normal; font-size: 10px; padding: 2px; width: '+a.css("width")+'; background-color: #ffc;">'),k.push('<strong style="font-size: 12px; white-space: nowrap;">Child '+e+"</strong><br />"),k.push("<strong>left:</strong> "+a.css("left")+"<br />"),k.push("<strong>top:</strong> "+a.css("top")+"<br />"),k.push("<strong>width:</strong> "+a.css("width")+"<br />"),k.push("<strong>opacity:</strong> "+a.css("opacity")+"<br />"),k.push("<strong>height:</strong> "+a.css("height")+"<br />"),k.push("<strong>z-index:</strong> "+a.css("z-index")+"<br />"),k.push("<strong>font-size:</strong> "+a.css("font-size")+"<br />"),k.push("<strong>scale:</strong> "+a.data("roundabout").currentScale),k.push("</div>"),a.html(k.join("")));a.trigger("reposition");d.apply(this);return g.isInFocus.apply(this,[m.degrees])},setBearing:function(a,b){b=b||function(){};a=g.normalize.apply(null,[a]);this.each(function(){var b,d=c(this),f=d.data("roundabout"),m=f.bearing;f.bearing=a;d.trigger("bearingSet");g.updateChildren.apply(d);b=Math.abs(m-a);!f.animating||180<b||(b=Math.abs(m-a),d.children(f.childSelector).each(function(b){g.isChildBackDegreesBetween.apply(c(this),[a,m])&&(b=m>a?"Clockwise":"Counterclockwise",c(this).trigger("move"+b+"ThroughBack"))}))});b.apply(this);return this},adjustBearing:function(a,b){b=b||function(){};if(0===a)return this;this.each(function(){g.setBearing.apply(c(this),[c(this).data("roundabout").bearing+a])});b.apply(this);return this},setTilt:function(a,b){b=b||function(){};this.each(function(){c(this).data("roundabout").tilt=a;g.updateChildren.apply(c(this))});b.apply(this);return this},adjustTilt:function(a,b){b=b||function(){};this.each(function(){g.setTilt.apply(c(this),[c(this).data("roundabout").tilt+a])});b.apply(this);return this},animateToBearing:function(a,b,h,d,f){var m=(new Date).getTime();f=f||function(){};c.isFunction(d)?(f=d,d=null):c.isFunction(h)?(f=h,h=null):c.isFunction(b)&&(f=b,b=null);this.each(function(){var k,n,p=c(this),l=p.data("roundabout"),q=b?b:l.duration,r=h?h:l.easing||"swing";d||(d={timerStart:m,start:l.bearing,totalTime:q});k=m-d.timerStart;l.stopAnimation?(g.allowAnimation.apply(p),l.animating=!1):k<q?(l.animating||p.trigger("animationStart"),l.animating=!0,"string"===typeof c.easing.def?(n=c.easing[r]||c.easing[c.easing.def],k=n(null,k,d.start,a-d.start,d.totalTime)):k=c.easing[r](k/d.totalTime,k,d.start,a-d.start,d.totalTime),0<=g.compareVersions.apply(null,[c().jquery,"1.7.2"])&&!c.easing.easeOutBack&&(k=d.start+(a-d.start)*k),k=g.normalize.apply(null,[k]),l.dragBearing=k,g.setBearing.apply(p,[k,function(){setTimeout(function(){g.animateToBearing.apply(p,[a,q,r,d,f])},0)}])):(l.lastAnimationStep=!0,a=g.normalize.apply(null,[a]),g.setBearing.apply(p,[a,function(){p.trigger("animationEnd")}]),l.animating=!1,l.lastAnimationStep=!1,l.dragBearing=a,f.apply(p))});return this},animateToNearbyChild:function(a,b){var h=a[0],d=a[1],f=a[2]||function(){};c.isFunction(d)?(f=d,d=null):c.isFunction(h)&&(f=h,h=null);return this.each(function(){var a,k,n,p=c(this),l=p.data("roundabout"),q=l.reflect?l.bearing:l.bearing%360,r=p.children(l.childSelector).length;if(!l.animating)if(l.reflect&&"previous"===b||!l.reflect&&"next"===b)for(q=Math.abs(q)<l.floatComparisonThreshold?360:q,n=0;n<r;n+=1){if(a=l.period*n,k=l.period*(n+1),k=n===r-1?360:k,q<=Math.ceil(k)&&q>=Math.floor(a)){2===r&&360===q?g.animateToDelta.apply(p,[-180,h,d,f]):g.animateBearingToFocus.apply(p,[a,h,d,f]);break}}else for(q=Math.abs(q)<l.floatComparisonThreshold||360-Math.abs(q)<l.floatComparisonThreshold?0:q,n=r-1;0<=n;--n)if(a=l.period*n,k=l.period*(n+1),k=n===r-1?360:k,q>=Math.floor(a)&&q<Math.ceil(k)){2===r&&360===q?g.animateToDelta.apply(p,[180,h,d,f]):g.animateBearingToFocus.apply(p,[k,h,d,f]);break}})},animateToNearestChild:function(a,b,h){h=h||function(){};c.isFunction(b)?(h=b,b=null):c.isFunction(a)&&(h=a,a=null);return this.each(function(){var d=g.getNearestChild.apply(c(this));g.animateToChild.apply(c(this),[d,a,b,h])})},animateToChild:function(a,b,h,d){d=d||function(){};c.isFunction(h)?(d=h,h=null):c.isFunction(b)&&(d=b,b=null);return this.each(function(){var f,m=c(this);f=m.data("roundabout");f.childInFocus===a||f.animating||(f=m.children(f.childSelector).eq(a),"undefined"!==typeof f&&"undefined"!==typeof f.data("roundabout")&&g.animateBearingToFocus.apply(m,[f.data("roundabout").degrees,b,h,d]))})},animateToNextChild:function(a,b,c){return g.animateToNearbyChild.apply(this,[arguments,"next"])},animateToPreviousChild:function(a,b,c){return g.animateToNearbyChild.apply(this,[arguments,"previous"])},animateToDelta:function(a,b,h,d){d=d||function(){};c.isFunction(h)?(d=h,h=null):c.isFunction(b)&&(d=b,b=null);return this.each(function(){var f=c(this).data("roundabout").bearing+a;g.animateToBearing.apply(c(this),[f,b,h,d])})},animateBearingToFocus:function(a,b,h,d){d=d||function(){};c.isFunction(h)?(d=h,h=null):c.isFunction(b)&&(d=b,b=null);return this.each(function(){var f=c(this).data("roundabout").bearing-a,f=Math.abs(360-f)<Math.abs(f)?360-f:-f,f=180<f?-(360-f):f;0!==f&&g.animateToDelta.apply(c(this),[f,b,h,d])})},stopAnimation:function(){return this.each(function(){c(this).data("roundabout").stopAnimation=!0})},allowAnimation:function(){return this.each(function(){c(this).data("roundabout").stopAnimation=!1})},startAutoplay:function(a){return this.each(function(){var b=c(this),h=b.data("roundabout");a=a||h.autoplayCallback||function(){};clearInterval(h.autoplayInterval);h.autoplayInterval=setInterval(function(){g.animateToNextChild.apply(b,[a])},h.autoplayDuration);h.autoplayIsRunning=!0;b.trigger("autoplayStart")})},stopAutoplay:function(a){return this.each(function(){clearInterval(c(this).data("roundabout").autoplayInterval);c(this).data("roundabout").autoplayInterval=null;c(this).data("roundabout").autoplayIsRunning=!1;a||c(this).unbind(".autoplay");c(this).trigger("autoplayStop")})},toggleAutoplay:function(a){return this.each(function(){var b=c(this).data("roundabout");a=a||b.autoplayCallback||function(){};g.isAutoplaying.apply(c(this))?g.stopAutoplay.apply(c(this),[a]):g.startAutoplay.apply(c(this),[a])})},isAutoplaying:function(){return this.data("roundabout").autoplayIsRunning},changeAutoplayDuration:function(a){return this.each(function(){var b=c(this);b.data("roundabout").autoplayDuration=a;g.isAutoplaying.apply(b)&&(g.stopAutoplay.apply(b),setTimeout(function(){g.startAutoplay.apply(b)},10))})},normalize:function(a){a%=360;return 0>a?360+a:a},normalizeRad:function(a){for(;0>a;)a+=2*Math.PI;for(;a>2*Math.PI;)a-=2*Math.PI;return a},isChildBackDegreesBetween:function(a,b){var h=c(this).data("roundabout").backDegrees;return a>b?h>=b&&h<a:h<b&&h>=a},getAnimateToMethod:function(a){a=a.toLowerCase();return"next"===a?"animateToNextChild":"previous"===a?"animateToPreviousChild":"animateToNearestChild"},relayoutChildren:function(){return this.each(function(){var a=c(this),b=c.extend({},a.data("roundabout"));b.startingChild=a.data("roundabout").childInFocus;g.init.apply(a,[b,null,!0])})},getNearestChild:function(){var a=c(this),b=a.data("roundabout"),a=a.children(b.childSelector).length;return b.reflect?Math.round(b.bearing/b.period)%a:(a-Math.round(b.bearing/b.period)%a)%a},degToRad:function(a){return g.normalize.apply(null,[a])*Math.PI/180},getPlacement:function(a){var b=this.data("roundabout");return b.reflect?b.period*a:360-b.period*a},isInFocus:function(a){var b=this.data("roundabout"),c=g.normalize.apply(null,[b.bearing]);a=g.normalize.apply(null,[a]);a=Math.abs(c-a);return a<=b.floatComparisonThreshold||a>=360-b.floatComparisonThreshold},getChildInFocus:function(){var a=c(this).data("roundabout");return"undefined"!==typeof a?-1<a.childInFocus?a.childInFocus:!1:!1},compareVersions:function(a,b){var c,d=a.split(/\./i),f=b.split(/\./i),g=d.length>f.length?d.length:f.length;for(c=0;c<=g;c++){if(d[c]&&!f[c]&&0!==parseInt(d[c],10))return 1;if(f[c]&&!d[c]&&0!==parseInt(f[c],10))return-1;if(d[c]!==f[c]&&d[c]&&f[c])return parseInt(d[c],10)>parseInt(f[c],10)?1:-1}return 0}};c.fn.roundabout=function(a){if(g[a])return g[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"===typeof a||c.isFunction(a)||!a)return g.init.apply(this,arguments);c.error("Method "+a+" does not exist for jQuery.roundabout.")}})(jQuery);
